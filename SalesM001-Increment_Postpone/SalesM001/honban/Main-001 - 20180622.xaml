<Activity mc:Ignorable="sap sap2010 sads" x:Class="SalesM001" mva:VisualBasic.Settings="{x:Null}" sap2010:WorkflowViewState.IdRef="Mail_Trigger_Sample_1"
 xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities"
 xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
 xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities"
 xmlns:s="clr-namespace:System;assembly=mscorlib"
 xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger"
 xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation"
 xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation"
 xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib"
 xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib"
 xmlns:sd="clr-namespace:System.Data;assembly=System.Data"
 xmlns:snm="clr-namespace:System.Net.Mail;assembly=System"
 xmlns:ui="http://schemas.uipath.com/workflow/activities"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Windows.Shapes</x:String>
      <x:String>System.Windows.Controls</x:String>
      <x:String>System.Windows.Documents</x:String>
      <x:String>System.Windows.Shell</x:String>
      <x:String>System.Windows.Navigation</x:String>
      <x:String>System.Windows.Data</x:String>
      <x:String>System.Windows</x:String>
      <x:String>System.Windows.Controls.Primitives</x:String>
      <x:String>System.Windows.Media.Animation</x:String>
      <x:String>System.Windows.Input</x:String>
      <x:String>System.Windows.Media</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Windows.Automation</x:String>
      <x:String>System.Windows.Media.TextFormatting</x:String>
      <x:String>System.Windows.Ink</x:String>
      <x:String>System.Windows.Media.Effects</x:String>
      <x:String>System.Windows.Media.Imaging</x:String>
      <x:String>System.Windows.Media.Media3D</x:String>
      <x:String>System.Windows.Forms.Integration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>System</x:String>
      <x:String>System.Activities.Debugger.Symbol</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Management.Automation</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Activities</x:String>
      <x:String>UiPath.Library</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Collections</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Database</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>WindowsFormsIntegration</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Management.Automation</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Library</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <TryCatch DisplayName="Try catch" sap2010:WorkflowViewState.IdRef="TryCatch_2">
    <TryCatch.Variables>
      <Variable x:TypeArguments="ui:DatabaseConnection" Name="dbconn" />
    </TryCatch.Variables>
    <TryCatch.Try>
      <Flowchart DisplayName="Process Logic" sap2010:WorkflowViewState.IdRef="Flowchart_1">
        <Flowchart.Variables>
          <Variable x:TypeArguments="x:String" Name="email" />
          <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="listGetGmail" />
          <Variable x:TypeArguments="snm:MailMessage" Name="mailMessage" />
          <Variable x:TypeArguments="x:String" Default="【增量/延期申请】" Name="Const_Keyword_ZouryoEnki" />
          <Variable x:TypeArguments="x:String" Default="imap.yaskawa.com.cn" Name="Const_IMAP_Server" />
          <Variable x:TypeArguments="x:String" Default="m.sales@yaskawa.com.cn" Name="Const_IMAP_Mail_Account" />
          <Variable x:TypeArguments="x:String" Default="Sales000" Name="password" />
          <Variable x:TypeArguments="x:String" Default="&lt;BR&gt;&lt;BR&gt;此邮件由系统自动发送，请勿回复此邮件，如有问题请联系相关人员。&lt;BR&gt;This email is sent by system. Please DO NOT reply this email. If you have any questions, please contact with whom concerned.&lt;BR&gt;" Name="endingMessage" />
        </Flowchart.Variables>
        <Flowchart.StartNode>
          <FlowStep x:Name="__ReferenceID3" sap2010:WorkflowViewState.IdRef="FlowStep_7">
            <ui:LogMessage DisplayName="Log message" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="SalesM001 process started." />
            <FlowStep.Next>
              <FlowStep x:Name="__ReferenceID0" sap2010:WorkflowViewState.IdRef="FlowStep_3">
                <Sequence DisplayName="Read new email message and process" sap2010:WorkflowViewState.IdRef="Sequence_1">
                  <Assign DisplayName="Set Gmail email account" sap2010:WorkflowViewState.IdRef="Assign_1">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[email]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[Const_IMAP_Mail_Account]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:CommentOut DisplayName="Comment out" sap2010:WorkflowViewState.IdRef="CommentOut_6">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_38">
                        <ui:GetPassword DisplayName="Get password" sap2010:WorkflowViewState.IdRef="GetPassword_2" ProtectedPassword="AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAhrjAiADtA0ioWOkdZcW4kAAAAAACAAAAAAAQZgAAAAEAACAAAACilt5GVpg7W/DO1QmvPqaBVfKOw9bJzxPW6V+7srizNgAAAAAOgAAAAAIAACAAAABesGo+vDQhkJNMPE2INiZ6bVcG+nWBt7oLlzOFG7QuGxAAAACZWKQhIewXPR3U/XmpS4ktQAAAAEK9Welf5I3udZiftWgwRE786PKQCIqz6q0vYt6dbKqa30tRFSBj9XKWnCNGp3uvVnZTDLOpNtmzoTzwDs1fmHw=" Result="[password]" />
                      </Sequence>
                    </ui:CommentOut.Body>
                  </ui:CommentOut>
                  <ui:Comment sap2010:WorkflowViewState.IdRef="Comment_3" Text="// Read new email from a mail account and not mark it as read. And to move target mails to another folder." />
                  <ui:GetIMAPMailMessages TimeoutMS="{x:Null}" DeleteMessages="False" DisplayName="Get IMAP mail messages" Email="[email]" EnableSSL="True" sap2010:WorkflowViewState.IdRef="GetIMAPMailMessages_1" MailFolder="Inbox" MarkAsRead="False" Messages="[listGetGmail]" OnlyUnreadMessages="True" Password="[password]" Port="143" SecureConnection="Auto" Server="[Const_IMAP_Server]" Top="100" />
                  <If Condition="[listGetGmail IsNot Nothing]" sap2010:WorkflowViewState.IdRef="If_1">
                    <If.Then>
                      <Sequence sap2010:WorkflowViewState.IdRef="Sequence_8">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="listGetMail2" />
                        </Sequence.Variables>
                        <ui:ForEach x:TypeArguments="snm:MailMessage" DisplayName="For each" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[listGetGmail]">
                          <ui:ForEach.Body>
                            <ActivityAction x:TypeArguments="snm:MailMessage">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="item" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Body" sap2010:WorkflowViewState.IdRef="Sequence_7">
                                <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_4" Text="[item.Subject]" />
                                <If Condition="[item.Subject.Contains(Const_Keyword_ZouryoEnki)]" DisplayName="If(process target mail)" sap2010:WorkflowViewState.IdRef="If_3">
                                  <If.Then>
                                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_9">
                                      <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_6" Text="【增量/延期申请】" />
                                      <ui:MoveIMAPMailMessageToFolder DisplayName="Move IMAP Mail Message" Email="[email]" EnableSSL="True" FromFolder="Inbox" sap2010:WorkflowViewState.IdRef="MoveIMAPMailMessageToFolder_2" MailFolder="[Const_Keyword_ZouryoEnki]" MailMessage="[item]" Password="[password]" Port="143" SecureConnection="Auto" Server="[Const_IMAP_Server]" />
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_7" Text="NOT 【增量/延期申请】" />
                                  </If.Else>
                                </If>
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEach.Body>
                        </ui:ForEach>
                        <ui:GetIMAPMailMessages TimeoutMS="{x:Null}" DeleteMessages="False" DisplayName="Get top 30 unread mail messages from another folder" Email="[email]" EnableSSL="True" sap2010:WorkflowViewState.IdRef="GetIMAPMailMessages_3" MailFolder="[Const_Keyword_ZouryoEnki]" MarkAsRead="True" Messages="[listGetMail2]" OnlyUnreadMessages="True" Password="[password]" Port="143" SecureConnection="Auto" Server="[Const_IMAP_Server]" Top="30" />
                        <ui:ForEach x:TypeArguments="snm:MailMessage" DisplayName="For each" sap2010:WorkflowViewState.IdRef="ForEach`1_3" Values="[listGetMail2]">
                          <ui:ForEach.Body>
                            <ActivityAction x:TypeArguments="snm:MailMessage">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="item" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Body" sap2010:WorkflowViewState.IdRef="Sequence_11">
                                <If Condition="[item isnot nothing]" sap2010:WorkflowViewState.IdRef="If_4">
                                  <If.Then>
                                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_12">
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" UnSafe="False" WorkflowFileName="Process_Email.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="x:String" x:Key="Body">[item.Body]</InArgument>
                                          <InArgument x:TypeArguments="snm:AttachmentCollection" x:Key="attachedFiles">[item.Attachments]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="subject">[item.Subject]</InArgument>
                                          <InArgument x:TypeArguments="snm:MailMessage" x:Key="mailMessage">[item]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="mail_account">[email]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="mail_account_pwd">[password]</InArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                      <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_8" Text="[item.Subject &amp; &quot; has processed.&quot;]" />
                                    </Sequence>
                                  </If.Then>
                                </If>
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEach.Body>
                        </ui:ForEach>
                      </Sequence>
                    </If.Then>
                  </If>
                </Sequence>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID1" sap2010:WorkflowViewState.IdRef="FlowStep_4">
                    <Sequence DisplayName="Execute Mail Process" sap2010:WorkflowViewState.IdRef="Sequence_13">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="sd:DataTable" Name="dtData" />
                      </Sequence.Variables>
                      <ui:DatabaseConnect DatabaseConnection="[dbconn]" DisplayName="Connect" sap2010:WorkflowViewState.IdRef="DatabaseConnect_1" ProviderName="System.Data.SqlClient" ConnectionString="Data Source=192.168.2.7;Initial Catalog=yasukawa;Persist Security Info=True;User ID=flow;Password=p@ssw0rd" />
                      <ui:ExecuteQuery ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtData]" DisplayName="Execute query" ExistingDbConnection="[dbconn]" sap2010:WorkflowViewState.IdRef="ExecuteQuery_1" Sql="select * from FL_TR_RPA_SALES001_MAIL where rpa_process_flag='0'">
                        <ui:ExecuteQuery.Parameters>
                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                        </ui:ExecuteQuery.Parameters>
                      </ui:ExecuteQuery>
                      <ui:ForEach x:TypeArguments="sd:DataRow" DisplayName="For each" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[dtData.Rows]">
                        <ui:ForEach.Body>
                          <ActivityAction x:TypeArguments="sd:DataRow">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="item" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Body" sap2010:WorkflowViewState.IdRef="Sequence_14">
                              <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_10" Text="[&quot;mail_type=&quot; &amp; item(&quot;mail_type&quot;).ToString]" />
                              <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_11" Text="[&quot;mail_file_path=&quot; &amp; item(&quot;mail_file_path&quot;).ToString]" />
                              <If Condition="[item(&quot;mail_type&quot;).ToString=&quot;NG&quot;]" sap2010:WorkflowViewState.IdRef="If_5">
                                <If.Then>
                                  <Sequence DisplayName="Process NG Mail" sap2010:WorkflowViewState.IdRef="Sequence_15">
                                    <Sequence.Variables>
                                      <Variable x:TypeArguments="x:String" Name="strBodyTemp1" />
                                      <Variable x:TypeArguments="x:String" Name="strFromTemp1" />
                                      <Variable x:TypeArguments="x:String" Name="strCCTemp1" />
                                      <Variable x:TypeArguments="x:String" Name="strSubjectTemp1" />
                                      <Variable x:TypeArguments="x:String" Name="newReply" />
                                    </Sequence.Variables>
                                    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke ReadMailContents workflow" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_4" UnSafe="False" WorkflowFileName="ReadMailContents.xaml">
                                      <ui:InvokeWorkflowFile.Arguments>
                                        <OutArgument x:TypeArguments="x:String" x:Key="strSubjectTemp">[strSubjectTemp1]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="strFromTemp">[strFromTemp1]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="strCCTemp">[strCCTemp1]</OutArgument>
                                        <OutArgument x:TypeArguments="x:String" x:Key="strBodyTemp">[strBodyTemp1]</OutArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="strFilePath">[item("mail_file_path").ToString]</InArgument>
                                      </ui:InvokeWorkflowFile.Arguments>
                                    </ui:InvokeWorkflowFile>
                                    <Assign sap2010:WorkflowViewState.IdRef="Assign_3">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[newReply]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String" xml:space="preserve">["您好！&lt;BR&gt;&lt;BR&gt;" &amp; "您的增量/延期申请[特价申请号：" &amp; item("sap_apply_no").ToString &amp; "]我们审批没有通过，理由如下：&lt;BR&gt;&lt;BR&gt;&lt;B&gt;"  &amp; item("comments").tostring.Replace(vbcrlf,"&lt;BR&gt;") &amp; "&lt;/B&gt;&lt;BR&gt;&lt;BR&gt;安川电机中国&lt;BR&gt;"]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_24" Text="[&quot;newReply=&quot; &amp; newReply]" />
                                    <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_25" Text="[&quot;strFromTemp1=&quot; &amp; strFromTemp1]" />
                                    <ui:SendMail Bcc="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[newReply+ strBodyTemp1]" Cc="[strCCTemp1]" DisplayName="Send SMTP Mail Message" Email="[Const_IMAP_Mail_Account]" EnableSSL="True" sap2010:WorkflowViewState.IdRef="SendMail_1" IsBodyHtml="True" Password="[password]" Port="25" SecureConnection="Auto" Server="smtp.yaskawa.com.cn" Subject="[&quot;自动回复：&quot; &amp; strSubjectTemp1]" To="[strFromTemp1]">
                                      <ui:SendMail.Files>
                                        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                      </ui:SendMail.Files>
                                    </ui:SendMail>
                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DisplayName="Execute non query" ExistingDbConnection="[dbconn]" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_1" Sql="update FL_TR_RPA_SALES001_MAIL set rpa_process_flag='1',update_date=convert(nvarchar,GETDATE(),20) where mail_auto_no=@mail_auto_no">
                                      <ui:ExecuteNonQuery.Parameters>
                                        <InArgument x:TypeArguments="x:Object" x:Key="mail_auto_no">[item("mail_auto_no").ToString]</InArgument>
                                      </ui:ExecuteNonQuery.Parameters>
                                    </ui:ExecuteNonQuery>
                                  </Sequence>
                                </If.Then>
                              </If>
                            </Sequence>
                          </ActivityAction>
                        </ui:ForEach.Body>
                      </ui:ForEach>
                    </Sequence>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID2" sap2010:WorkflowViewState.IdRef="FlowStep_5">
                        <TryCatch DisplayName="Execute SAP Operation" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                          <TryCatch.Try>
                            <Sequence DisplayName="Execute SAP Operation" sap2010:WorkflowViewState.IdRef="Sequence_16">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="sd:DataTable" Name="dtData2" />
                                <Variable x:TypeArguments="x:Boolean" Default="False" Name="sap_login_succeed" />
                                <Variable x:TypeArguments="sd:DataTable" Name="dtData3" />
                                <Variable x:TypeArguments="x:Boolean" Default="False" Name="tmpProcessFlag" />
                              </Sequence.Variables>
                              <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_22" Text="Execute SAP Operation Start." />
                              <ui:ExecuteQuery ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtData2]" DisplayName="Execute query(get fl_auto_no list)" ExistingDbConnection="[dbconn]" sap2010:WorkflowViewState.IdRef="ExecuteQuery_3" Sql="select distinct fl_auto_no,apply_kubun,mail_file_path,sap_apply_no from FL_TR_RPA_SALES001 where rpa_process_flag='0' order by fl_auto_no">
                                <ui:ExecuteQuery.Parameters>
                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                </ui:ExecuteQuery.Parameters>
                              </ui:ExecuteQuery>
                              <ui:ForEach x:TypeArguments="sd:DataRow" DisplayName="For each" sap2010:WorkflowViewState.IdRef="ForEach`1_7" Values="[dtData2.Rows]">
                                <ui:ForEach.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="item1" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Body" sap2010:WorkflowViewState.IdRef="Sequence_23">
                                      <ui:ExecuteQuery ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtData3]" DisplayName="Execute query" ExistingDbConnection="[dbconn]" sap2010:WorkflowViewState.IdRef="ExecuteQuery_2" Sql="select * from FL_TR_RPA_SALES001 where rpa_process_flag='0' and fl_auto_no=@fl_auto_no order by line_no">
                                        <ui:ExecuteQuery.Parameters>
                                          <InArgument x:TypeArguments="x:String" x:Key="fl_auto_no">[item1("fl_auto_no").ToString]</InArgument>
                                        </ui:ExecuteQuery.Parameters>
                                      </ui:ExecuteQuery>
                                      <If Condition="[dtData3.Rows.Count&gt;0]" sap2010:WorkflowViewState.IdRef="If_7">
                                        <If.Then>
                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_20">
                                            <If Condition="[sap_login_succeed=false]" sap2010:WorkflowViewState.IdRef="If_12">
                                              <If.Then>
                                                <Sequence sap2010:WorkflowViewState.IdRef="Sequence_24">
                                                  <Assign DisplayName="Assign :TODO to delete before release" sap2010:WorkflowViewState.IdRef="Assign_12">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Boolean">[sap_login_succeed]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:CommentOut DisplayName="Comment out TODO" sap2010:WorkflowViewState.IdRef="CommentOut_4">
                                                    <ui:CommentOut.Body>
                                                      <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_36">
                                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_6" UnSafe="False" WorkflowFileName="D:\RPA\000.模块\SAP_Login\Main.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <InArgument x:TypeArguments="x:String" x:Key="sap_id" />
                                                            <InArgument x:TypeArguments="x:String" x:Key="sap_pw" />
                                                            <InArgument x:TypeArguments="x:String" x:Key="sap_test_id" />
                                                            <InArgument x:TypeArguments="x:String" x:Key="sap_test_pw" />
                                                            <InArgument x:TypeArguments="x:Boolean" x:Key="sap_testing" />
                                                            <InOutArgument x:TypeArguments="x:String" x:Key="sap_log" />
                                                            <OutArgument x:TypeArguments="x:Boolean" x:Key="sap_login_succeed">[sap_login_succeed]</OutArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                      </Sequence>
                                                    </ui:CommentOut.Body>
                                                  </ui:CommentOut>
                                                  <ui:SendHotkey DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" DisplayName="Send hotkey" EmptyField="False" sap2010:WorkflowViewState.IdRef="SendHotkey_1" Key="enter" KeyModifiers="None" SendWindowMessages="False" SpecialKey="True">
                                                    <ui:SendHotkey.Target>
                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="{x:Null}" WaitForReady="INTERACTIVE" />
                                                    </ui:SendHotkey.Target>
                                                  </ui:SendHotkey>
                                                </Sequence>
                                              </If.Then>
                                            </If>
                                            <If Condition="[sap_login_succeed]" sap2010:WorkflowViewState.IdRef="If_8">
                                              <If.Then>
                                                <Sequence sap2010:WorkflowViewState.IdRef="Sequence_22">
                                                  <Assign sap2010:WorkflowViewState.IdRef="Assign_7">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:Boolean">[tmpProcessFlag]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <ui:ForEach x:TypeArguments="sd:DataRow" DisplayName="For each" sap2010:WorkflowViewState.IdRef="ForEach`1_5" Values="[dtData3.Rows]">
                                                    <ui:ForEach.Body>
                                                      <ActivityAction x:TypeArguments="sd:DataRow">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="sd:DataRow" Name="item3" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Body" sap2010:WorkflowViewState.IdRef="Sequence_18">
                                                          <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_12" Text="[&quot;line_no=&quot; &amp; item3(&quot;line_no&quot;).ToString]" />
                                                          <If Condition="[item3(&quot;apply_type&quot;).ToString=&quot;1&quot; or item3(&quot;apply_type&quot;).ToString=&quot;3&quot;]" DisplayName="If(1:增量；3:增量和延期)" sap2010:WorkflowViewState.IdRef="If_6">
                                                            <If.Then>
                                                              <Sequence DisplayName="Process 增量" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                                                <Sequence.Variables>
                                                                  <Variable x:TypeArguments="x:String" Name="strBodyTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="strFromTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="strCCTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="strSubjectTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="newReply" />
                                                                  <Variable x:TypeArguments="x:String" Name="strQuantity" />
                                                                  <Variable x:TypeArguments="x:Boolean" Default="False" Name="tmpCancelFlag" />
                                                                </Sequence.Variables>
                                                                <Assign sap2010:WorkflowViewState.IdRef="Assign_6">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[strQuantity]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">[item3("tokka_apply_quantity").ToString]</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                                <If Condition="[item3(&quot;tokka_final_quantity&quot;).ToString &lt;&gt; &quot;&quot; and item3(&quot;tokka_final_quantity&quot;) isnot nothing]" sap2010:WorkflowViewState.IdRef="If_10">
                                                                  <If.Then>
                                                                    <Assign sap2010:WorkflowViewState.IdRef="Assign_5">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[strQuantity]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[item3("tokka_final_quantity").ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </If.Then>
                                                                </If>
                                                                <If Condition="[item3(&quot;cancel_flag&quot;).ToString=&quot;1&quot;]" sap2010:WorkflowViewState.IdRef="If_13">
                                                                  <If.Then>
                                                                    <Assign sap2010:WorkflowViewState.IdRef="Assign_9">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:Boolean">[tmpCancelFlag]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <Assign sap2010:WorkflowViewState.IdRef="Assign_10">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:Boolean">[tmpCancelFlag]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </If.Else>
                                                                </If>
                                                                <If Condition="[strQuantity&lt;&gt;&quot;&quot;]" sap2010:WorkflowViewState.IdRef="If_11">
                                                                  <If.Then>
                                                                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_27">
                                                                      <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_15" Text="[&quot;sap_apply_no=&quot; &amp; item3(&quot;sap_apply_no&quot;).ToString]" />
                                                                      <ui:CommentOut DisplayName="Comment out TODO" sap2010:WorkflowViewState.IdRef="CommentOut_2">
                                                                        <ui:CommentOut.Body>
                                                                          <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_34">
                                                                            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_7" UnSafe="False" WorkflowFileName="SAP-VA22-Modify.xaml">
                                                                              <ui:InvokeWorkflowFile.Arguments>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="strTokkaNo">[item3("sap_apply_no").ToString]</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="No">[item3("line_no").ToString]</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="ItemNo">[item3("item_id").ToString]</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="ProcessType">QUANTITY</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="ProcessDate">[item3("final_date").ToString]</InArgument>
                                                                                <InArgument x:TypeArguments="x:String" x:Key="ProcessQuantity">[strQuantity]</InArgument>
                                                                                <InArgument x:TypeArguments="x:Boolean" x:Key="ProcessCancelFlag">[tmpCancelFlag]</InArgument>
                                                                              </ui:InvokeWorkflowFile.Arguments>
                                                                            </ui:InvokeWorkflowFile>
                                                                          </Sequence>
                                                                        </ui:CommentOut.Body>
                                                                      </ui:CommentOut>
                                                                    </Sequence>
                                                                  </If.Then>
                                                                </If>
                                                              </Sequence>
                                                            </If.Then>
                                                          </If>
                                                          <If Condition="[(item3(&quot;apply_type&quot;).ToString=&quot;2&quot; or item3(&quot;apply_type&quot;).ToString=&quot;3&quot;) and tmpProcessFlag=false]" DisplayName="If(2:延期；3:增量和延期)" sap2010:WorkflowViewState.IdRef="If_9">
                                                            <If.Then>
                                                              <Sequence DisplayName="Process 延期" sap2010:WorkflowViewState.IdRef="Sequence_21">
                                                                <Sequence.Variables>
                                                                  <Variable x:TypeArguments="x:String" Name="strBodyTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="strFromTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="strCCTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="strSubjectTemp1" />
                                                                  <Variable x:TypeArguments="x:String" Name="newReply" />
                                                                </Sequence.Variables>
                                                                <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_16" Text="SAP Date Modification Start." />
                                                                <ui:CommentOut DisplayName="Comment out TODO" sap2010:WorkflowViewState.IdRef="CommentOut_3">
                                                                  <ui:CommentOut.Body>
                                                                    <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_35">
                                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_9" UnSafe="False" WorkflowFileName="SAP-VA22-Modify.xaml">
                                                                        <ui:InvokeWorkflowFile.Arguments>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="strTokkaNo">[item3("sap_apply_no").ToString]</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="No">[item3("line_no").ToString]</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="ItemNo">[item3("item_id").ToString]</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="ProcessType">DATE</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="ProcessDate">[item3("final_date").ToString]</InArgument>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="ProcessQuantity" />
                                                                          <InArgument x:TypeArguments="x:Boolean" x:Key="ProcessCancelFlag" />
                                                                        </ui:InvokeWorkflowFile.Arguments>
                                                                      </ui:InvokeWorkflowFile>
                                                                    </Sequence>
                                                                  </ui:CommentOut.Body>
                                                                </ui:CommentOut>
                                                                <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_17" Text="SAP Date Modification End." />
                                                                <Assign sap2010:WorkflowViewState.IdRef="Assign_8">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:Boolean">[tmpProcessFlag]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </Sequence>
                                                            </If.Then>
                                                          </If>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:ForEach.Body>
                                                  </ui:ForEach>
                                                  <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DisplayName="Execute non query" ExistingDbConnection="[dbconn]" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_4" Sql="update FL_TR_RPA_SALES001 set rpa_process_flag='1',update_date=convert(nvarchar,GETDATE(),20) where fl_auto_no=@fl_auto_no">
                                                    <ui:ExecuteNonQuery.Parameters>
                                                      <InArgument x:TypeArguments="x:String" x:Key="fl_auto_no">[item1("fl_auto_no").ToString]</InArgument>
                                                    </ui:ExecuteNonQuery.Parameters>
                                                  </ui:ExecuteNonQuery>
                                                  <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_18" Text="[&quot;DB update sucessesfully.[fl_auto_no=]&quot; &amp; item1(&quot;fl_auto_no&quot;).ToString]" />
                                                  <If Condition="[item1(&quot;apply_kubun&quot;).ToString=&quot;1&quot;]" DisplayName="If dealer's application, need to send notice mail." sap2010:WorkflowViewState.IdRef="If_15">
                                                    <If.Then>
                                                      <Sequence DisplayName="Process NG Mail" sap2010:WorkflowViewState.IdRef="Sequence_26">
                                                        <Sequence.Variables>
                                                          <Variable x:TypeArguments="x:String" Name="strBodyTemp1" />
                                                          <Variable x:TypeArguments="x:String" Name="strFromTemp1" />
                                                          <Variable x:TypeArguments="x:String" Name="strCCTemp1" />
                                                          <Variable x:TypeArguments="x:String" Name="strSubjectTemp1" />
                                                          <Variable x:TypeArguments="x:String" Name="newReply" />
                                                        </Sequence.Variables>
                                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke ReadMailContents workflow" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_10" UnSafe="False" WorkflowFileName="ReadMailContents.xaml">
                                                          <ui:InvokeWorkflowFile.Arguments>
                                                            <OutArgument x:TypeArguments="x:String" x:Key="strSubjectTemp">[strSubjectTemp1]</OutArgument>
                                                            <OutArgument x:TypeArguments="x:String" x:Key="strFromTemp">[strFromTemp1]</OutArgument>
                                                            <OutArgument x:TypeArguments="x:String" x:Key="strCCTemp">[strCCTemp1]</OutArgument>
                                                            <OutArgument x:TypeArguments="x:String" x:Key="strBodyTemp">[strBodyTemp1]</OutArgument>
                                                            <InArgument x:TypeArguments="x:String" x:Key="strFilePath">[item1("mail_file_path").ToString]</InArgument>
                                                          </ui:InvokeWorkflowFile.Arguments>
                                                        </ui:InvokeWorkflowFile>
                                                        <Assign sap2010:WorkflowViewState.IdRef="Assign_11">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:String">[newReply]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:String" xml:space="preserve">["您好！&lt;BR&gt;&lt;BR&gt;" &amp; "您的增量/延期申请[特价申请号：" &amp; item1("sap_apply_no").ToString &amp; "]我们已经审批完成，详细请在DIX系统查看，谢谢！&lt;BR&gt;&lt;BR&gt;"   &amp; "&lt;BR&gt;&lt;BR&gt;安川电机中国&lt;BR&gt;"]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <ui:SendMail Bcc="{x:Null}" From="{x:Null}" MailMessage="{x:Null}" Name="{x:Null}" TimeoutMS="{x:Null}" Body="[newReply+endingMessage +strBodyTemp1]" Cc="[strCCTemp1]" DisplayName="Send SMTP Mail Message" Email="[Const_IMAP_Mail_Account]" EnableSSL="True" sap2010:WorkflowViewState.IdRef="SendMail_3" IsBodyHtml="True" Password="[password]" Port="25" SecureConnection="Auto" Server="smtp.yaskawa.com.cn" Subject="[&quot;自动回复：&quot; &amp; strSubjectTemp1]" To="[strFromTemp1]">
                                                          <ui:SendMail.Files>
                                                            <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                          </ui:SendMail.Files>
                                                        </ui:SendMail>
                                                        <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_20" Text="Mail the result to dealer sucessfully." />
                                                      </Sequence>
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                              </If.Then>
                                              <If.Else>
                                                <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_14" Text="Failed to login SAP." />
                                              </If.Else>
                                            </If>
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Sequence sap2010:WorkflowViewState.IdRef="Sequence_19">
                                            <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_13" Text="No data to process." />
                                          </Sequence>
                                        </If.Else>
                                      </If>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ForEach.Body>
                              </ui:ForEach>
                            </Sequence>
                          </TryCatch.Try>
                          <TryCatch.Catches>
                            <Catch x:TypeArguments="s:Exception" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                              <ActivityAction x:TypeArguments="s:Exception">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                </ActivityAction.Argument>
                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_11" UnSafe="False" WorkflowFileName="D:\RPA\000.模块\Send_Mail\Main.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="x:Boolean" x:Key="use_outlook">False</InArgument>
                                    <OutArgument x:TypeArguments="x:String" x:Key="error_message" />
                                    <OutArgument x:TypeArguments="x:Boolean" x:Key="result_succeed" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_to">huangxiaohan@yaskawa.com.cn</InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_cc" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_bcc" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_subject">[RPA Notice] 【增量/延期申请】Error happened</InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_body">["SAP Operation error happened:" &amp; vbcrlf &amp; exception.Message]</InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="smtp_sendername" />
                                    <InArgument x:TypeArguments="snm:MailMessage" x:Key="send_forward_mailmessage" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment1" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment2" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment3" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment4" />
                                    <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment5" />
                                    <InArgument x:TypeArguments="x:String" x:Key="outlook_account" />
                                    <InArgument x:TypeArguments="x:String" x:Key="smtp_account" />
                                    <InArgument x:TypeArguments="x:String" x:Key="smtp_password" />
                                    <InArgument x:TypeArguments="x:Boolean" x:Key="auto_flag" />
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                              </ActivityAction>
                            </Catch>
                          </TryCatch.Catches>
                          <TryCatch.Finally>
                            <ui:CommentOut DisplayName="Comment out--TODO" sap2010:WorkflowViewState.IdRef="CommentOut_5">
                              <ui:CommentOut.Body>
                                <Sequence DisplayName="Ignored Activities" sap2010:WorkflowViewState.IdRef="Sequence_37">
                                  <Sequence DisplayName="close sap.exe" sap2010:WorkflowViewState.IdRef="Sequence_31">
                                    <ui:CloseApplication ContinueOnError="True" DisplayName="Close application 'saplogon.exe SAP'" sap2010:WorkflowViewState.IdRef="CloseApplication_4">
                                      <ui:CloseApplication.Target>
                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" TimeoutMS="{x:Null}" InformativeScreenshot="515d2935bf65261f086f43d8faeae603" Selector="&lt;wnd app='saplogon.exe' cls='SAP_FRONTEND_SESSION' omit:title='SAP 轻松访问 -  用户菜单 Y032_RPA' /&gt;" WaitForReady="INTERACTIVE" />
                                      </ui:CloseApplication.Target>
                                    </ui:CloseApplication>
                                    <WriteLine DisplayName="Write line" sap2010:WorkflowViewState.IdRef="WriteLine_23" Text="Close SAP successfully." />
                                  </Sequence>
                                </Sequence>
                              </ui:CommentOut.Body>
                            </ui:CommentOut>
                          </TryCatch.Finally>
                        </TryCatch>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
            </FlowStep.Next>
          </FlowStep>
        </Flowchart.StartNode>
        <x:Reference>__ReferenceID0</x:Reference>
        <x:Reference>__ReferenceID1</x:Reference>
        <x:Reference>__ReferenceID2</x:Reference>
        <x:Reference>__ReferenceID3</x:Reference>
      </Flowchart>
    </TryCatch.Try>
    <TryCatch.Catches>
      <Catch x:TypeArguments="s:Exception" sap2010:WorkflowViewState.IdRef="Catch`1_2">
        <ActivityAction x:TypeArguments="s:Exception">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
          </ActivityAction.Argument>
          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke workflow file" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_12" UnSafe="False" WorkflowFileName="D:\RPA\000.模块\Send_Mail\Main.xaml">
            <ui:InvokeWorkflowFile.Arguments>
              <InArgument x:TypeArguments="x:Boolean" x:Key="use_outlook">False</InArgument>
              <OutArgument x:TypeArguments="x:String" x:Key="error_message" />
              <OutArgument x:TypeArguments="x:Boolean" x:Key="result_succeed" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_to" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_cc" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_bcc" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_subject">[RPA] SalesM001's process error happened.</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_body">[exception.Message &amp; exception.Source &amp; exception.StackTrace]</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="smtp_sendername">RPA</InArgument>
              <InArgument x:TypeArguments="snm:MailMessage" x:Key="send_forward_mailmessage" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment1" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment2" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment3" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment4" />
              <InArgument x:TypeArguments="x:String" x:Key="send_mail_attachment5" />
              <InArgument x:TypeArguments="x:String" x:Key="outlook_account" />
              <InArgument x:TypeArguments="x:String" x:Key="smtp_account">rpa@yaskawa.com.cn</InArgument>
              <InArgument x:TypeArguments="x:String" x:Key="smtp_password">1qaz@WSX</InArgument>
              <InArgument x:TypeArguments="x:Boolean" x:Key="auto_flag" />
            </ui:InvokeWorkflowFile.Arguments>
          </ui:InvokeWorkflowFile>
        </ActivityAction>
      </Catch>
    </TryCatch.Catches>
    <TryCatch.Finally>
      <Sequence DisplayName="Ending process" sap2010:WorkflowViewState.IdRef="Sequence_33">
        <If Condition="[dbconn isnot nothing]" sap2010:WorkflowViewState.IdRef="If_16">
          <If.Then>
            <ui:DatabaseDisconnect DatabaseConnection="[dbconn]" DisplayName="Disconnect" sap2010:WorkflowViewState.IdRef="DatabaseDisconnect_2" />
          </If.Then>
        </If>
      </Sequence>
    </TryCatch.Finally>
    <sads:DebugSymbol.Symbol>dztEOlxSUEFcU2FsZXNNMDAxLUluY3JlbWVudF9Qb3N0cG9uZVxTYWxlc00wMDFcTWFpbi0wMDEueGFtbPYBWwP/BA4CAQFgB9MEEwIBE/YEB/wEEgIBDdsEC/EEIwIBAmU4ZUMCARhmOGZNAgEXZzhnUAIBFmg4aEICARVpOGn9AQIBFG0NbZkBAwHHAnARvwEcAwHsAcIBFYMCIAMBrAGGAhnGBCQCARn3BAn7BA4CAQ7lBE7lBFECAQztBEvtBF0CAQvjBFDjBHkCAQrdBEvdBFACAQnuBEzuBFQCAQjkBE3kBJIBAgEE2wS4AdsE2wECAQNtem2WAQMByAJxE3gcAwHCAnkTfyMDAcECgAETgAG/AQMBwAKBAROBAZEDAwG0AoIBE74BGAMB7QHGARfGAbgCAwHnAccBF8sBKQMB4QHMAReCAiQDAa0BiAIdlAQoAgEhtwQdxAQtAgEgnAQhsgQ5AgEa9wQX9wQvAgEP+QQN+QSUAQIBEHY+dlcDAcUCcz9zRgMBwwKBAYkDgQGOAwMBvwKBAYIBgQGLAQMBvQKBAcoCgQHPAgMBvAKBAYQCgQGUAgMBugKBAe8CgQGEAwMBuAKBAbgCgQHEAgMBtgKBAeABgQHnAQMBtQKCASGCAT8DAe4BhAEXvAEiAwHwAcYBoAHGAbcBAwHrAcYByQHGAbUCAwHqAcYBPsYBSAMB6AHHAbEBxwG7AQMB5QHHAXXHAX8DAeMBxwHxAccBswIDAeIBzAGMAcwBmwEDAeAB0gEd/wEoAwGuAYsCT4sCVgIBI40CT40CVgIBIo8CH48CmAEDAaoBkAIflAIxAwGkAZUCH5MELAIBJKEEYaEEfAIBH6QEZqQEigECAR6eBGGeBGYCAR2lBGOlBKkBAgEcnATOAZwE8QECARv5BDf5BEECARGIARmeASYDAZcCnwEZnwHHAwMBigKgARm7ASYDAfEB0wEf0wG/AQMB3gHUAR/UAckBAwHcAdUBH/4BJAMBrwGPAnePApUBAwGrAZACzwGQAtkBAwGoAZACfZACiAEDAaYBkAKPApACmgMDAaUBlQKUAZUCpAEDAaMBmwIlkAQwAgEliAGTAYgBowEDAbICjgEfmwEqAwGYAp8BwAOfAcQDAwGWAp8BpQGfAa4BAwGUAp8BgQOfAYYDAwGTAp8BuwKfAcsCAwGRAp8BpgOfAbsDAwGPAp8B7wKfAfsCAwGNAp8BgwKfAZ8CAwGLAqABkwGgAaMBAwGIAqYBH7gBKgMB8gHTAXfTAbwBAwHfAdQBd9QBxgEDAd0B1QEt1QFkAwGwAdcBI/wBLgMBsQGcAiegAjkDAZwBoQInjwQsAgEmjwEhjwGLAQMBrwKQASGaASYDAZkCpwEhtwEmAwHzAd8BJecBPQMB0QHoASXvAS4DAc0B8AEl8AGoAQMBygHxASXxAbABAwHHAfIBJfYBMwMBtwH3ASX7AToDAbIBnALCAZwCzAEDAaEBngJlngKDAQMBoAGcAoUBnAKQAQMBngGcAoICnALrAgMBnQGhAjWhAlACASejAiuIBDYCASuLBCuNBDYCASiPAXiPAYgBAwGwApABL5ABYgMBmgKSASWVATADAZ8CmAElmAGOAQMBnQKnAS+nAUUDAfQBqQEltQEwAwH2AeMBY+MBbwMB2gHhAWjhAXkDAdgB5QFk5QGFAQMB1wHkAWXkAXMDAdUB4gFl4gFzAwHTAd8B3QHfAfQBAwHSAeoBUeoBWwMBzgHwAX3wAaUBAwHLAfEBffEBrQEDAcgB8gHiA/IB8gMDAcUB8gGwAfIBvgEDAcMB8gGSAfIBrAEDAcAB8gGzA/IB3gMDAb4B8gHqAfIBhQIDAbwB8gHxAvIB9QIDAbsB8gGVA/IBqgMDAboB8gHfAvIB6wIDAbgB9wHMAfcB1gEDAbUB+QFl+QGEAQMBtAH3AY8C9wGUAwMBswGkAi3HAjIDAZIByAIthwQyAgEsjAQtjASdAQIBKZMBJ5MBjAEDAa0ClAEnlAH1AgMBoAKYAXyYAYsBAwGeAqoBJ7MBPwMB+gG0ASe0AbMBAwH3AaQCO6QCVgMBkwGmAjHFAjwDAZUByAI7yAJQAgEtygIxggQ8AgExhQQxhQSiAQIBL4wEhQGMBJoBAgEqkwF+kwGJAQMBrgKUAXKUAXsDAasClAGYAZQBnwEDAaoClAG4ApQBvQIDAakClAHdApQB8gIDAacClAGmApQBsgIDAaUClAGUApQBnAIDAaMClAHrAZQBhwIDAaECrQF4rQGKAQMBhgKsAV+sAWoDAYQCrwFtrwFzAwGCArABZ7ABbgMBgAKuAWKuAXADAf4BqgHTAaoB5wEDAf0BsQFrsQF1AwH7AbQBfrQBsAEDAfgBpwIzrgI8AwGYAa8CM78CQwMBlwHAAjPEAkMDAZYBywIz0gI8AwGOAdMCM9cDQAIBXtgDM9wDSAIBWd0DM90D8AECAVfeAzOBBDgCATKFBIkBhQSfAQIBMKwCX6wCYwMBmwGpAmCpAnMDAZkB0AJf0AJkAwGRAc0CYM0CcAMBjwHTAqgB0wK4AQMBjQHZAjnUA0QCAV/YA9oB2APkAQIBXNoDcdoDjwECAVvYA50C2AOZAwIBWt0DiwHdA+0BAgFY3gNB3gN6AgEz4AM3/wNCAgE02gI72gLYAQMBiwHbAjurA0ACAWysAzvTA0ACAWDoAznwA1ECAUzxAzn4A0ICAUj5Azn9A0cCATf+Azn+A7wBAgE12gKTAdoC1QEDAYwB2wJJ2wK5AQIBbd0CP6kDSgIBbqwDSawD1AECAWGuAz/RA0oCAWLsA3fsA4MBAgFV6gN86gONAQIBU+4DeO4DmgECAVLtA3ntA4cBAgFQ6wN56wOHAQIBTugD8gHoA4kCAgFN8wNl8wNvAgFJ+QOEBPkDlAQCAUb5A9IB+QPgAQIBRPkDpgH5A84BAgFA+QPVA/kDgAQCAT75A4wC+QOnAgIBPPkDkwP5A5cDAgE7+QO3A/kDzAMCATr5A4ED+QONAwIBOP4DkQH+A7kBAgE25QJx5QJ4AgFv5wJB7gJKAwGHAe8CQfoCRgMBgQH7AkGQA0YCAXeRA0GoA0YCAXC2A0G2A7oBAgFqtwNBxwNRAgFpyANByAO4AQIBZ8kDQdADSgIBY+wCbOwClAEDAYoB6QJt6QJ6AwGIAe8CT+8C0wEDAYIB8QJF+AJOAwGDAfsCT/sCiAECAXj9AkWEA04CAX2HA0WOA04CAXmRA0+RA3ICAXGTA0WmA1ACAXO2A5kBtgO3AQIBa8gDmQHIA7UBAgFozgNtzgNxAgFmywNuywN+AgFk9gJw9gKYAQMBhgHzAnHzAn4DAYQBggNxggN1AwGAAf8Ccv8CgQECAX6MA3GMA3YCAXyJA3KJA4EBAgF6lANHlAPuAQIBdZUDR6UDVwIBdJQDnwGUA+sBAgF2</sads:DebugSymbol.Symbol>
  </TryCatch>
  <sap2010:WorkflowViewState.ViewStateManager>
    <sap2010:ViewStateManager>
      <sap2010:ViewStateData Id="LogMessage_1" sap:VirtualizedContainerService.HintSize="200,53">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Assign_1" sap:VirtualizedContainerService.HintSize="762,61" />
      <sap2010:ViewStateData Id="GetPassword_2" sap:VirtualizedContainerService.HintSize="200,22" />
      <sap2010:ViewStateData Id="Sequence_38" sap:VirtualizedContainerService.HintSize="222,146">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="CommentOut_6" sap:VirtualizedContainerService.HintSize="762,53">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Comment_3" sap:VirtualizedContainerService.HintSize="762,93" />
      <sap2010:ViewStateData Id="GetIMAPMailMessages_1" sap:VirtualizedContainerService.HintSize="762,22" />
      <sap2010:ViewStateData Id="WriteLine_4" sap:VirtualizedContainerService.HintSize="574,60" />
      <sap2010:ViewStateData Id="WriteLine_6" sap:VirtualizedContainerService.HintSize="314,60" />
      <sap2010:ViewStateData Id="MoveIMAPMailMessageToFolder_2" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Sequence_9" sap:VirtualizedContainerService.HintSize="336,311">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="WriteLine_7" sap:VirtualizedContainerService.HintSize="213,60" />
      <sap2010:ViewStateData Id="If_3" sap:VirtualizedContainerService.HintSize="574,457">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_7" sap:VirtualizedContainerService.HintSize="596,681">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ForEach`1_2" sap:VirtualizedContainerService.HintSize="612,814">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="GetIMAPMailMessages_3" sap:VirtualizedContainerService.HintSize="612,22" />
      <sap2010:ViewStateData Id="InvokeWorkflowFile_3" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="WriteLine_8" sap:VirtualizedContainerService.HintSize="314,60" />
      <sap2010:ViewStateData Id="Sequence_12" sap:VirtualizedContainerService.HintSize="336,311">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_4" sap:VirtualizedContainerService.HintSize="469,457" />
      <sap2010:ViewStateData Id="Sequence_11" sap:VirtualizedContainerService.HintSize="491,581">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ForEach`1_3" sap:VirtualizedContainerService.HintSize="612,714">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_8" sap:VirtualizedContainerService.HintSize="634,1754">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_1" sap:VirtualizedContainerService.HintSize="762,1907">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_1" sap:VirtualizedContainerService.HintSize="784,2420">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="DatabaseConnect_1" sap:VirtualizedContainerService.HintSize="502,59" />
      <sap2010:ViewStateData Id="ExecuteQuery_1" sap:VirtualizedContainerService.HintSize="502,88" />
      <sap2010:ViewStateData Id="WriteLine_10" sap:VirtualizedContainerService.HintSize="464,63" />
      <sap2010:ViewStateData Id="WriteLine_11" sap:VirtualizedContainerService.HintSize="464,63" />
      <sap2010:ViewStateData Id="InvokeWorkflowFile_4" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Assign_3" sap:VirtualizedContainerService.HintSize="314,61" />
      <sap2010:ViewStateData Id="WriteLine_24" sap:VirtualizedContainerService.HintSize="314,63" />
      <sap2010:ViewStateData Id="WriteLine_25" sap:VirtualizedContainerService.HintSize="314,63" />
      <sap2010:ViewStateData Id="SendMail_1" sap:VirtualizedContainerService.HintSize="314,151">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ExecuteNonQuery_1" sap:VirtualizedContainerService.HintSize="314,88" />
      <sap2010:ViewStateData Id="Sequence_15" sap:VirtualizedContainerService.HintSize="336,837">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_5" sap:VirtualizedContainerService.HintSize="464,990" />
      <sap2010:ViewStateData Id="Sequence_14" sap:VirtualizedContainerService.HintSize="486,1320">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ForEach`1_4" sap:VirtualizedContainerService.HintSize="502,1457">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_13" sap:VirtualizedContainerService.HintSize="200,53">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="WriteLine_22" sap:VirtualizedContainerService.HintSize="1278,60" />
      <sap2010:ViewStateData Id="ExecuteQuery_3" sap:VirtualizedContainerService.HintSize="1278,88" />
      <sap2010:ViewStateData Id="ExecuteQuery_2" sap:VirtualizedContainerService.HintSize="1240,88" />
      <sap2010:ViewStateData Id="Assign_12" sap:VirtualizedContainerService.HintSize="314,60" />
      <sap2010:ViewStateData Id="InvokeWorkflowFile_6" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Sequence_36" sap:VirtualizedContainerService.HintSize="336,211">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="CommentOut_4" sap:VirtualizedContainerService.HintSize="314,50">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="SendHotkey_1" sap:VirtualizedContainerService.HintSize="314,115" />
      <sap2010:ViewStateData Id="Sequence_24" sap:VirtualizedContainerService.HintSize="336,429">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_12" sap:VirtualizedContainerService.HintSize="958,575" />
      <sap2010:ViewStateData Id="Assign_7" sap:VirtualizedContainerService.HintSize="698,60" />
      <sap2010:ViewStateData Id="WriteLine_12" sap:VirtualizedContainerService.HintSize="660,60" />
      <sap2010:ViewStateData Id="Assign_6" sap:VirtualizedContainerService.HintSize="505,60" />
      <sap2010:ViewStateData Id="Assign_5" sap:VirtualizedContainerService.HintSize="240,60" />
      <sap2010:ViewStateData Id="If_10" sap:VirtualizedContainerService.HintSize="505,206" />
      <sap2010:ViewStateData Id="Assign_9" sap:VirtualizedContainerService.HintSize="240,60" />
      <sap2010:ViewStateData Id="Assign_10" sap:VirtualizedContainerService.HintSize="240,60" />
      <sap2010:ViewStateData Id="If_13" sap:VirtualizedContainerService.HintSize="505,206" />
      <sap2010:ViewStateData Id="WriteLine_15" sap:VirtualizedContainerService.HintSize="213,60" />
      <sap2010:ViewStateData Id="InvokeWorkflowFile_7" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Sequence_34" sap:VirtualizedContainerService.HintSize="336,211">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="CommentOut_2" sap:VirtualizedContainerService.HintSize="213,50">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_27" sap:VirtualizedContainerService.HintSize="235,274">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_11" sap:VirtualizedContainerService.HintSize="505,420">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_17" sap:VirtualizedContainerService.HintSize="527,1136">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_6" sap:VirtualizedContainerService.HintSize="660,1282">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="WriteLine_16" sap:VirtualizedContainerService.HintSize="240,60" />
      <sap2010:ViewStateData Id="InvokeWorkflowFile_9" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Sequence_35" sap:VirtualizedContainerService.HintSize="336,211">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="CommentOut_3" sap:VirtualizedContainerService.HintSize="240,50">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="WriteLine_17" sap:VirtualizedContainerService.HintSize="240,60" />
      <sap2010:ViewStateData Id="Assign_8" sap:VirtualizedContainerService.HintSize="240,60" />
      <sap2010:ViewStateData Id="Sequence_21" sap:VirtualizedContainerService.HintSize="262,474">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_9" sap:VirtualizedContainerService.HintSize="660,620">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_18" sap:VirtualizedContainerService.HintSize="682,2166">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ForEach`1_5" sap:VirtualizedContainerService.HintSize="698,2299">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ExecuteNonQuery_4" sap:VirtualizedContainerService.HintSize="698,88" />
      <sap2010:ViewStateData Id="WriteLine_18" sap:VirtualizedContainerService.HintSize="698,60" />
      <sap2010:ViewStateData Id="InvokeWorkflowFile_10" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Assign_11" sap:VirtualizedContainerService.HintSize="314,60" />
      <sap2010:ViewStateData Id="SendMail_3" sap:VirtualizedContainerService.HintSize="314,144">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="WriteLine_20" sap:VirtualizedContainerService.HintSize="314,60" />
      <sap2010:ViewStateData Id="Sequence_26" sap:VirtualizedContainerService.HintSize="336,595">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_15" sap:VirtualizedContainerService.HintSize="698,741">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_22" sap:VirtualizedContainerService.HintSize="720,3532">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="WriteLine_14" sap:VirtualizedContainerService.HintSize="213,60" />
      <sap2010:ViewStateData Id="If_8" sap:VirtualizedContainerService.HintSize="958,3678">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_20" sap:VirtualizedContainerService.HintSize="980,4417">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="WriteLine_13" sap:VirtualizedContainerService.HintSize="213,60" />
      <sap2010:ViewStateData Id="Sequence_19" sap:VirtualizedContainerService.HintSize="235,184">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="If_7" sap:VirtualizedContainerService.HintSize="1240,4563">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_23" sap:VirtualizedContainerService.HintSize="1262,4815">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ForEach`1_7" sap:VirtualizedContainerService.HintSize="1278,4948">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_16" sap:VirtualizedContainerService.HintSize="1300,5300">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="InvokeWorkflowFile_11" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Catch`1_1" sap:VirtualizedContainerService.HintSize="420,20">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="CloseApplication_4" sap:VirtualizedContainerService.HintSize="314,106" />
      <sap2010:ViewStateData Id="WriteLine_23" sap:VirtualizedContainerService.HintSize="314,60" />
      <sap2010:ViewStateData Id="Sequence_31" sap:VirtualizedContainerService.HintSize="200,50">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_37" sap:VirtualizedContainerService.HintSize="222,174">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="CommentOut_5" sap:VirtualizedContainerService.HintSize="416,252" />
      <sap2010:ViewStateData Id="TryCatch_1" sap:VirtualizedContainerService.HintSize="200,53" />
      <sap2010:ViewStateData Id="FlowStep_5">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">190,415</av:Point>
            <av:Size x:Key="ShapeSize">200,53</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_4">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">190,315</av:Point>
            <av:Size x:Key="ShapeSize">200,53</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">290,368 290,415</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_3">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">190,215</av:Point>
            <av:Size x:Key="ShapeSize">200,53</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">290,268 290,315</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_7">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">190,125</av:Point>
            <av:Size x:Key="ShapeSize">200,53</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">290,178 290,215</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Flowchart_1" sap:VirtualizedContainerService.HintSize="622,741">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <av:Point x:Key="ShapeLocation">260,2.5</av:Point>
            <av:Size x:Key="ShapeSize">60,75</av:Size>
            <x:Double x:Key="Width">608</x:Double>
            <av:PointCollection x:Key="ConnectorLocation">290,77.5 290,125</av:PointCollection>
            <x:Double x:Key="Height">705.156666666667</x:Double>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="InvokeWorkflowFile_12" sap:VirtualizedContainerService.HintSize="314,87" />
      <sap2010:ViewStateData Id="Catch`1_2" sap:VirtualizedContainerService.HintSize="626,23">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="DatabaseDisconnect_2" sap:VirtualizedContainerService.HintSize="200,22" />
      <sap2010:ViewStateData Id="If_16" sap:VirtualizedContainerService.HintSize="464,213" />
      <sap2010:ViewStateData Id="Sequence_33" sap:VirtualizedContainerService.HintSize="486,337">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="TryCatch_2" sap:VirtualizedContainerService.HintSize="640,978" />
      <sap2010:ViewStateData Id="Mail_Trigger_Sample_1" sap:VirtualizedContainerService.HintSize="680,1058" />
    </sap2010:ViewStateManager>
  </sap2010:WorkflowViewState.ViewStateManager>
</Activity>